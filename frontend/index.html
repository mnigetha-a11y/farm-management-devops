<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Farm Management System</title>
<style>
/* CSS remains the same as your previous version for background images */
:root { --primary:#2e7d32; --bg:#f4f7f4; --danger:#d32f2f; --secondary: #1b5e20; }
body { margin:0; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:var(--bg); }
#login { height:100vh; display:flex; justify-content:center; align-items:center; background:linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&w=1200'); background-size:cover; }
.card { background:rgba(255,255,255,0.9); padding:30px; border-radius:12px; width:300px; text-align:center; box-shadow: 0 10px 25px rgba(0,0,0,0.2); backdrop-filter: blur(5px); }
input, button { width:100%; padding:12px; margin:10px 0; border-radius:6px; box-sizing: border-box; border: 1px solid #ccc; }
button { background:var(--primary); color:white; border:none; cursor:pointer; font-weight: bold; transition: 0.3s; }
button:hover { background: var(--secondary); }
#dashboard { display:none; }
nav { background:var(--primary); color:white; padding:15px 30px; display:flex; justify-content:space-between; align-items: center; }
.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; padding:20px 30px; }
.box { background-size: cover; background-position: center; padding:25px; border-radius:15px; box-shadow:0 6px 15px rgba(0,0,0,0.15); cursor: pointer; transition: 0.3s; color: white; position: relative; overflow: hidden; min-height: 180px; }
.box::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.2) 100%); z-index: 1; }
.box > * { position: relative; z-index: 2; }
.bg-soil { background-image: url('https://images.unsplash.com/photo-1592982537447-7440770cbfc9?auto=format&fit=crop&w=500'); }
.bg-irrigation { background-image: url('https://images.unsplash.com/photo-1563514227147-6d2ff665a6a0?auto=format&fit=crop&w=500'); }
.bg-livestock { background-image: url('https://images.unsplash.com/photo-1516467508483-a7212febe31a?auto=format&fit=crop&w=500'); }
.bg-register { background-image: url('https://images.unsplash.com/photo-1464226184884-fa280b87c399?auto=format&fit=crop&w=500'); }
.bg-inventory { background-image: url('https://images.unsplash.com/photo-1523348837708-15d4a09cfac2?auto=format&fit=crop&w=500'); }
.form-input { background: rgba(255,255,255,0.9) !important; color: #333; }
table { width:100%; border-collapse:collapse; background: rgba(255,255,255,0.95); color: #333; }
th, td { padding:12px; border-bottom:1px solid #eee; text-align: left; }
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
.modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 600px; position: relative; }
</style>
</head>
<body>

<div id="login">
  <div class="card">
    <h2 style="color:var(--primary)">Smart Farm Portal</h2>
    <input type="text" id="user" placeholder="Username">
    <input type="password" id="pass" placeholder="Password">
    <button onclick="doLogin()">Login</button>
  </div>
</div>

<div id="dashboard">
  <nav><h3>ðŸŒ¿ Smart Farm Dashboard</h3><button onclick="location.reload()">Logout</button></nav>
  <div class="grid">
    <div class="box bg-soil" onclick="openSoilAnalysis()"><h3>Soil Moisture</h3><p>Analysis Report â†’</p></div>
    <div class="box bg-irrigation" onclick="openIrrigationReport()"><h3>Irrigation</h3><p>System Active â†’</p></div>
    <div class="box bg-livestock" onclick="openLivestockReport()"><h3>Livestock</h3><p>120 Units â†’</p></div>
  </div>
  <div class="grid">
    <div class="box bg-register">
      <h3>âž• Register New Crop</h3>
      <input type="text" id="cName" class="form-input" placeholder="Crop Name">
      <input type="text" id="cArea" class="form-input" placeholder="Area">
      <button onclick="saveToBackend()">Save to Server</button>
    </div>
    <div class="box bg-inventory">
      <h3>ðŸŒ¾ Farm Inventory</h3>
      <table>
        <thead><tr><th>Crop</th><th>Area</th><th>Action</th></tr></thead>
        <tbody id="inventoryList"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
const API_URL = "http://localhost:3001/api/crops"; // Backend Port

function doLogin(){
  if(document.getElementById("user").value==="admin" && document.getElementById("pass").value==="admin123"){
    document.getElementById("login").style.display="none";
    document.getElementById("dashboard").style.display="block";
    loadFromBackend();
  } else alert("Wrong credentials!");
}

// POST: Data-va server-kku anuppa
async function saveToBackend() {
    const name = document.getElementById("cName").value;
    const area = document.getElementById("cArea").value;
    if(!name || !area) return alert("Fields fill pannunga!");

    const response = await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, area, status: "Growing" })
    });

    if(response.ok) {
        document.getElementById("cName").value = "";
        document.getElementById("cArea").value = "";
        loadFromBackend();
    }
}

// GET: Server-la irunthu data-va edukka
async function loadFromBackend() {
    const response = await fetch(API_URL);
    const data = await response.json();
    let html = "";
    data.forEach((item, index) => {
        html += `<tr><td>${item.name}</td><td>${item.area}</td>
        <td><button onclick="deleteFromBackend(${index})" style="background:red; color:white; border:none; padding:4px 8px; cursor:pointer;">Delete</button></td></tr>`;
    });
    document.getElementById("inventoryList").innerHTML = html;
}

// DELETE: Server-la irunthu data-va neekka
async function deleteFromBackend(index) {
    await fetch(`${API_URL}/${index}`, { method: 'DELETE' });
    loadFromBackend();
}
</script>
</body>
</html>